
@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties - Essential globals only */
:root {
  /* Code block colors for light theme */
  --code-bg: 33 33 33;
  --code-text: 240 240 240;
  --inline-code-bg: 240 240 240;
  --inline-code-text: 33 33 33;
  
  /* Highlight/selection colors */
  --selection-bg: 112 135 148;
}

.dark {
  /* Code blocks for dark theme */
  --code-bg: 23 23 23;
  --code-text: 240 240 240;
  --inline-code-bg: 55 55 55;
  --inline-code-text: 240 240 240;
}

/* Base Styles */
* {
  @apply border-primary-200 dark:border-primary-700;
}

html {
  scroll-behavior: smooth;
  scroll-padding-top: 2rem;
}

body {
  @apply bg-primary-50 dark:bg-primary-900 text-primary-900 dark:text-primary-100;
  font-feature-settings: "rlig" 1, "calt" 1;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Scrollbar Hiding */
::-webkit-scrollbar {
  display: none;
}

* {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Selection Colors */
::selection {
  background-color: rgb(var(--selection-bg) / 0.2);
  color: inherit;
}

::-moz-selection {
  background-color: rgb(var(--selection-bg) / 0.2);
  color: inherit;
}

/* Code block selection - theme independent */
pre ::selection,
code ::selection,
.prose pre ::selection,
.prose code ::selection,
pre ::-moz-selection,
code ::-moz-selection,
.prose pre ::-moz-selection,
.prose code ::-moz-selection {
  background-color: rgba(100, 116, 139, 0.3) !important;
  color: inherit !important;
}

/* Focus Styles */
:focus-visible {
  @apply outline-2 outline-highlight-500 dark:outline-highlight-400 outline-offset-2;
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 500;
  line-height: 1.3;
  color: rgb(var(--color-foreground));
}

/* Links */
a {
  @apply text-highlight-600 dark:text-highlight-400 no-underline transition-colors duration-200;
}

a:hover {
  @apply text-highlight-700 dark:text-highlight-300 opacity-80;
}

/* Wikilinks */
.wikilink {
  @apply text-highlight-600 dark:text-highlight-400 font-medium no-underline border-b border-dashed border-highlight-500/50 transition-all duration-200;
}

.wikilink:hover {
  @apply text-highlight-700 dark:text-highlight-300 opacity-80 border-solid;
}

.wikilink-broken {
  @apply text-red-500 cursor-not-allowed line-through;
}

/* Code Styles - Simplified and Theme Independent */
code {
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  font-size: 0.875em;
  background-color: rgb(var(--inline-code-bg));
  color: rgb(var(--inline-code-text));
  padding: 0.375rem;
  border-radius: 0.25rem;
}

pre {
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  background-color: rgb(var(--code-bg));
  color: rgb(var(--code-text));
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
}

/* Code inside pre blocks */
pre code {
  background-color: transparent;
  color: inherit;
  padding: 0;
  border-radius: 0;
}

/* Syntax highlighting (astro-code) */
.astro-code,
pre.astro-code {
  background-color: rgb(var(--code-bg)) !important;
  color: rgb(var(--code-text)) !important;
  padding: 1rem !important;
  border-radius: 0.5rem !important;
  overflow-x: auto !important;
}

.astro-code code,
pre.astro-code code {
  background-color: transparent !important;
  color: inherit !important;
  padding: 0 !important;
  border-radius: 0 !important;
}

/* Keyboard Shortcuts */
kbd {
  @apply inline-flex items-center px-2 py-1 text-xs font-medium bg-primary-100 dark:bg-primary-800 text-primary-800 dark:text-primary-200 border border-primary-300 dark:border-primary-600 rounded shadow-sm;
}

/* Button Styles - Consolidated */
.btn {
  @apply inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer border no-underline;
  text-decoration: none !important;
  user-select: none;
  vertical-align: middle;
  white-space: nowrap;
}

.btn:hover {
  text-decoration: none !important;
}

.btn:disabled {
  @apply opacity-50 cursor-not-allowed pointer-events-none;
}

.btn-primary {
  @apply bg-highlight-600 dark:bg-highlight-500 text-white hover:bg-highlight-700 dark:hover:bg-highlight-600;
}

.btn-secondary {
  @apply bg-highlight-100 dark:bg-highlight-900/50 hover:bg-highlight-200 dark:hover:bg-highlight-800/50;
}

.btn-outline {
  @apply border border-highlight-400 dark:border-highlight-500 text-highlight-700 dark:text-highlight-300 bg-transparent;
}

.btn-ghost {
  @apply text-highlight-600 dark:text-highlight-400 hover:bg-highlight-50 dark:hover:bg-highlight-900/30 border-transparent bg-transparent;
}

/* Button Groups */
.btn-group {
  @apply flex flex-wrap gap-2;
}

.btn-group-center {
  @apply flex flex-wrap gap-2 justify-center;
}

@media (max-width: 640px) {
  .btn-group {
    @apply flex-col;
  }
  .btn-group .btn {
    @apply w-full justify-center;
  }
}

/* Card Styles */
.card {
  @apply bg-white dark:bg-primary-900 border border-primary-200 dark:border-primary-700 rounded-lg shadow-sm;
}

/* Form Styles */
input[type="text"],
input[type="email"],
input[type="search"],
textarea {
  @apply block w-full px-3 py-2 border border-primary-300 dark:border-primary-600 rounded-lg bg-white dark:bg-primary-800 text-primary-900 dark:text-primary-100 placeholder-primary-500 dark:placeholder-primary-400 focus:outline-none focus:ring-2 focus:ring-highlight-500 focus:border-transparent;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes scaleIn {
  from { transform: scale(0.95); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.animate-fade-in { animation: fadeIn 0.2s ease-in-out; }
.animate-slide-up { animation: slideUp 0.3s ease-out; }
.animate-scale-in { animation: scaleIn 0.2s ease-out; }

/* Callout Styles */
.callout {
  @apply p-4 my-6 rounded-lg border-l-4;
}

.callout-title {
  @apply flex items-center gap-2 font-semibold mb-2;
}

.callout-icon {
  @apply w-4 h-4 flex-shrink-0;
}

.callout-content {
  @apply text-sm;
}

.callout-content > *:first-child { @apply mt-0; }
.callout-content > *:last-child { @apply mb-0; }

.callout-note {
  @apply bg-blue-50 dark:bg-blue-950/30 border-blue-400 dark:border-blue-600;
}
.callout-note .callout-title { @apply text-blue-700 dark:text-blue-300; }
.callout-note .callout-content { @apply text-blue-800 dark:text-blue-200; }

.callout-tip {
  @apply bg-green-50 dark:bg-green-950/30 border-green-400 dark:border-green-600;
}
.callout-tip .callout-title { @apply text-green-700 dark:text-green-300; }
.callout-tip .callout-content { @apply text-green-800 dark:text-green-200; }

.callout-important {
  @apply bg-purple-50 dark:bg-purple-950/30 border-purple-400 dark:border-purple-600;
}
.callout-important .callout-title { @apply text-purple-700 dark:text-purple-300; }
.callout-important .callout-content { @apply text-purple-800 dark:text-purple-200; }

.callout-warning {
  @apply bg-yellow-50 dark:bg-yellow-950/30 border-yellow-400 dark:border-yellow-600;
}
.callout-warning .callout-title { @apply text-yellow-700 dark:text-yellow-300; }
.callout-warning .callout-content { @apply text-yellow-800 dark:text-yellow-200; }

.callout-caution {
  @apply bg-red-50 dark:bg-red-950/30 border-red-400 dark:border-red-600;
}
.callout-caution .callout-title { @apply text-red-700 dark:text-red-300; }
.callout-caution .callout-content { @apply text-red-800 dark:text-red-200; }

/* Image Grid Layouts */
.prose .image-grid {
  display: grid;
  gap: 0.5rem;
  margin: 1.5rem 0;
  max-width: 100%;
}

.prose .image-grid-2,
.prose .image-grid-3,
.prose .image-grid-4,
.prose .image-grid-5,
.prose .image-grid-6 {
  grid-template-columns: 1fr;
}

@media (min-width: 600px) {
  .prose .image-grid-2,
  .prose .image-grid-3,
  .prose .image-grid-4,
  .prose .image-grid-5,
  .prose .image-grid-6 { grid-template-columns: 1fr 1fr; }
}

@media (min-width: 900px) {
  .prose .image-grid-3,
  .prose .image-grid-4,
  .prose .image-grid-5,
  .prose .image-grid-6 { grid-template-columns: 1fr 1fr 1fr 1fr; }
}

@media (min-width: 1400px) {
  .prose .image-grid-5 { grid-template-columns: 1fr 1fr 1fr 1fr 1fr; }
  .prose .image-grid-6 { grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr; }
}

.prose .image-grid img,
.prose .image-grid picture {
  width: 100%;
  height: auto;
  object-fit: cover;
  border-radius: 0.5rem;
  margin: 0;
  display: block;
  max-width: 100%;
}

/* Prose Styles */
.prose {
  @apply text-primary-700 dark:text-primary-300;
}

.prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
  @apply font-semibold text-primary-900 dark:text-primary-50;
  scroll-margin-top: 8rem;
}

.prose h1 { @apply text-xl mt-8 mb-6; }
.prose h2 { @apply text-lg mt-8 mb-4; }
.prose h3 { @apply text-base mt-6 mb-3; }
.prose h4 { @apply text-base mt-5 mb-2; }
.prose h5 { @apply text-base mt-4 mb-2; }
.prose h6 { @apply text-base mt-4 mb-2; }

.prose h1 a, .prose h2 a, .prose h3 a, .prose h4 a, .prose h5 a, .prose h6 a {
  @apply text-primary-900 dark:text-primary-50 no-underline transition-colors duration-200;
}

.prose h1 a:hover, .prose h2 a:hover, .prose h3 a:hover, .prose h4 a:hover, .prose h5 a:hover, .prose h6 a:hover {
  @apply text-highlight-600 dark:text-highlight-400 no-underline;
}

.prose a {
  @apply text-highlight-600 dark:text-highlight-400 font-medium no-underline hover:underline;
}

.prose a:hover {
  @apply text-highlight-700 dark:text-highlight-300;
}

.prose strong {
  @apply text-primary-900 dark:text-primary-200 font-semibold;
}

.prose blockquote {
  @apply border-l-4 border-primary-300 dark:border-primary-600 pl-6 py-2 bg-primary-50 dark:bg-primary-800/30 rounded-lg;
}

.prose img {
  @apply rounded-lg shadow-sm;
}

.prose mark {
  @apply bg-highlight-100 dark:bg-highlight-900/30 text-highlight-800 dark:text-highlight-200 px-1 py-0.5 rounded;
}

/* Lists */
.prose ul, .prose ol { @apply my-1; }
.prose li { @apply my-0; }
.prose li > p { @apply my-0; }
.prose ul > li, .prose ol > li { @apply pl-1; }

.prose ul li input[type="checkbox"] { @apply mr-2; }

.prose ul li:has(input[type="checkbox"]) {
  list-style: none;
  margin-left: -1.5rem;
  padding-left: 1.5rem;
}

.prose > ul.contains-task-list {
  padding-left: 0 !important;
}

/* Tables */
.prose table {
  @apply border-collapse border border-primary-300 dark:border-primary-600 w-full;
}

.table-wrapper {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  margin: 1.5rem 0;
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
}

.table-wrapper table {
  margin: 0 !important;
  width: 100%;
  min-width: 500px;
}

.prose th, .prose td {
  @apply border border-primary-300 dark:border-primary-600 px-4 py-2;
  white-space: nowrap;
  min-width: 100px;
}

.prose th {
  @apply bg-primary-100 dark:bg-primary-700 font-semibold text-primary-900 dark:text-primary-100;
  position: sticky;
  top: 0;
  z-index: 10;
}

@media (min-width: 768px) {
  .prose th, .prose td {
    white-space: normal;
    min-width: auto;
  }
}

@media (max-width: 767px) {
  .prose table {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }
  .prose th, .prose td {
    @apply px-3 py-2;
    min-width: 80px;
  }
}

/* Utility Classes */
.text-balance { text-wrap: balance; }
.text-pretty { text-wrap: pretty; }
.btn-center { @apply flex justify-center; }
.btn-left { @apply flex justify-start; }
.btn-right { @apply flex justify-end; }

/* Theme Transitions */
:root, html, body, [data-theme], .theme-transition {
  transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out;
}

/* Loading States */
.loading { @apply animate-pulse; }
.skeleton { @apply bg-primary-200 dark:bg-primary-700 rounded; }

/* Mobile Responsive */
@media (max-width: 640px) {
  html { scroll-padding-top: 1rem; }
  .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 { scroll-margin-top: 6rem; }
  .prose sup a, .prose .footnote-ref, .prose .footnotes, .prose .footnote { scroll-margin-top: 6rem; }
}

/* Accessibility */
@media (prefers-contrast: high) {
  .wikilink { border-bottom-width: 2px; }
  .btn { @apply border-2; }
}

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  html { scroll-behavior: auto; }
}

/* Print Styles */
@media print {
  .no-print { display: none !important; }
  body { @apply text-black bg-white; }
  a { @apply text-black no-underline; }
  .prose a::after {
    content: " (" attr(href) ")";
    @apply text-sm text-gray-600;
  }
}
